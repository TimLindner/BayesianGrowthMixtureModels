---
output:
  html_document:
    toc: true
    toc_depth: 2
    toc_float: TRUE
---


```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


```{r, include = FALSE}
# README
# required files from SimulationStudyData/Model1 folder:
# SimCase1_Yobs_SimRun1.xlsx

# required files from SimulationStudyData/Model3 folder:
# SimCase17_Yobs_SimRun1.xlsx
# SimCase17_Yobslog_SimRun1.xlsx

# required files from SimulationStudyData/Model3 folder:
# SimCase18_Yobs_SimRun1.xlsx
# SimCase18_Yobslog_SimRun1.xlsx

# required files from SimulationStudyData/Model5 folder:
# SimCase29_Yobs_SimRun1.xlsx
```


```{r, include = FALSE}
# set working directory
setwd("C:/Users/Diiim/Documents/Github/BayesianGMMs/SimulationStudyData")

# set decimals to digits instead of scientific
options(scipen = 999)

# load packages
library(flextable)
library(readxl)
```


# Overview
```{r}
# simulation case
sim_case <- c("1",
              "2",
              "3",
              "4",
              "5",
              "6",
              "15",
              "16",
              "17",
              "18",
              "29")

# model
m <- c("1",
       "1",
       "1",
       "1",
       "1",
       "1",
       "3",
       "3",
       "3",
       "3",
       "5")

# number of latent classes
C <- c("baseline",
       "2",
       "2",
       "2",
       "3",
       "3",
       "2",
       "2",
       "2",
       "2",
       "2")

# characteristic
descrip <- c("-",
             "classes do not overlap",
             "overlapping constants",
             "intersecting trends",
             "classes do not overlap",
             "overlapping constants",
             "-",
             "classes do not overlap",
             "overlapping constants",
             "intersecting trends",
             "classes do not overlap")

# number of simulation runs
R <- c(5,
       5,
       5,
       5,
       5,
       5,
       5,
       5,
       5,
       5,
       5)

# table
df <- data.frame(sim_case,
                 m,
                 C,
                 descrip,
                 R)

# column names for table
names(df) <- c("Simulation case",
               "Model",
               "Number latent classes",
               "Description",
               "Number simulation runs")

# print table
flextable(df)
```


# Visualizations
## Simulation case 1
Within each simulation run, for $n$ in $1,...,50$ and $t$ in $1,...,10$,

$\boldsymbol{y}^{obs}_{n} \sim Normal(10 + 1 \, \boldsymbol{x}_{n},0.75)\text{;}$

where $\boldsymbol{x}_{n} = (0,1,2,3,4,5,6,7,8,9)$


```{r}
# load observed dependent variable
Y_obs <- data.frame(read_excel("Model1/SimCase1_Yobs_SimRun1.xlsx",
                               sheet = "Sheet 1"))
  
# number of individuals
N <- dim(Y_obs)[1]
  
# number of time periods
no_periods <- dim(Y_obs)[2]
  
# indexes t
indexes_t <- 1:no_periods
  
# plot Y_obs
plot(x = indexes_t,
     y = c(min(Y_obs),
           max(Y_obs),
           rep(min(Y_obs), times = no_periods-2)),
     type = "l",
     col = "white",
     main = "Observed dependent variable for simulation run 1",
     xlab = "t",
     ylab = "y_obs")
  
grid(nx = NA, ny = NULL)
par(new = TRUE)
  
for (n in 1:N) {
  lines(x = indexes_t,
        y = Y_obs[n,],
        col = "orange")
}
  
box()
```


## Simulation case 2
Within each simulation run, for $n$ in $1,...,200$ and $t$ in $1,...,10$,

* $\boldsymbol{y}^{obs}_{n} \sim Normal(-5 - 0.5 \, \boldsymbol{x}_{n},0.25) \quad \text{if } z_n = 1\text{,}$

* $\boldsymbol{y}^{obs}_{n} \sim Normal(10 + 1 \, \boldsymbol{x}_{n},0.75) \quad \text{if } z_n = 2\text{, and}$

* $z_n \sim Categorical(0.3,0.7)\text{;}$

where $\boldsymbol{x}_{n} = (0,1,2,3,4,5,6,7,8,9)$


```{r}
# load observed dependent variable
Y_obs <- data.frame(read_excel("Model1/Dataset2_Yobs.xlsx", sheet = "Sheet 1"))

# number of individuals
N <- dim(Y_obs)[1]

# number of time periods
no_periods <- dim(Y_obs)[2]

# indexes t
indexes_t <- 1:no_periods

# plot Y_obs
plot(x = indexes_t,
     y = c(min(Y_obs),
           max(Y_obs),
           rep(min(Y_obs), times = no_periods-2)),
     type = "l",
     col = "white",
     main = "Observed dependent variable",
     xlab = "t",
     ylab = "y_obs")
  
grid(nx = NA, ny = NULL)
par(new = TRUE)
  
for (n in 1:N) {
  lines(x = indexes_t,
        y = Y_obs[n,],
        col = "orange")
}

box()
```


## Simulation case 3
Within each simulation run, for $n$ in $1,...,200$ and $t$ in $1,...,10$,

* $\boldsymbol{y}^{obs}_{n} \sim Normal(2 - 0.5 \, \boldsymbol{x}_{n},0.25) \quad \text{if } z_n = 1\text{,}$

* $\boldsymbol{y}^{obs}_{n} \sim Normal(3 + 1 \, \boldsymbol{x}_{n},0.75) \quad \text{if } z_n = 2\text{, and}$

* $z_n \sim Categorical(0.3,0.7)\text{;}$

where $\boldsymbol{x}_{n} = (0,1,2,3,4,5,6,7,8,9)$


```{r}
# load observed dependent variable
Y_obs <- data.frame(read_excel("Model1/Dataset3_Yobs.xlsx", sheet = "Sheet 1"))

# number of individuals
N <- dim(Y_obs)[1]

# number of time periods
no_periods <- dim(Y_obs)[2]

# indexes t
indexes_t <- 1:no_periods

# plot Y_obs
plot(x = indexes_t,
     y = c(min(Y_obs),
           max(Y_obs),
           rep(min(Y_obs), times = no_periods-2)),
     type = "l",
     col = "white",
     main = "Observed dependent variable",
     xlab = "t",
     ylab = "y_obs")
  
grid(nx = NA, ny = NULL)
par(new = TRUE)
  
for (n in 1:N) {
  lines(x = indexes_t,
        y = Y_obs[n,],
        col = "orange")
}

box()
```


## Simulation case 4
Within each simulation run, for $n$ in $1,...,200$ and $t$ in $1,...,10$,

* $\boldsymbol{y}^{obs}_{n} \sim Normal(-5 + 1 \, \boldsymbol{x}_{n},0.25) \quad \text{if } z_n = 1\text{,}$

* $\boldsymbol{y}^{obs}_{n} \sim Normal(10 - 2 \, \boldsymbol{x}_{n},0.75) \quad \text{if } z_n = 2\text{, and}$

* $z_n \sim Categorical(0.3,0.7)\text{;}$

where $\boldsymbol{x}_{n} = (0,1,2,3,4,5,6,7,8,9)$


```{r}
# load observed dependent variable
Y_obs <- data.frame(read_excel("Model1/Dataset4_Yobs.xlsx", sheet = "Sheet 1"))

# number of individuals
N <- dim(Y_obs)[1]

# number of time periods
no_periods <- dim(Y_obs)[2]

# indexes t
indexes_t <- 1:no_periods

# plot Y_obs
plot(x = indexes_t,
     y = c(min(Y_obs),
           max(Y_obs),
           rep(min(Y_obs), times = no_periods-2)),
     type = "l",
     col = "white",
     main = "Observed dependent variable",
     xlab = "t",
     ylab = "y_obs")
  
grid(nx = NA, ny = NULL)
par(new = TRUE)
  
for (n in 1:N) {
  lines(x = indexes_t,
        y = Y_obs[n,],
        col = "orange")
}

box()
```


## Simulation case 5
Within each simulation run, for $n$ in $1,...,250$ and $t$ in $1,...,10$,

* $\boldsymbol{y}^{obs}_{n} \sim Normal(-5 - 0.5 \, \boldsymbol{x}_{n},0.25) \quad \text{if } z_n = 1\text{,}$

* $\boldsymbol{y}^{obs}_{n} \sim Normal(2.5 + 0.5 \, \boldsymbol{x}_{n},0.5) \quad \text{if } z_n = 2\text{,}$

* $\boldsymbol{y}^{obs}_{n} \sim Normal(10 + 1 \, \boldsymbol{x}_{n},0.75) \quad \text{if } z_n = 3\text{, and}$

* $z_n \sim Categorical(0.3,0.2,0.5)\text{;}$

where $\boldsymbol{x}_{n} = (0,1,2,3,4,5,6,7,8,9)$


```{r}
# load observed dependent variable
Y_obs <- data.frame(read_excel("Model1/Dataset5_Yobs.xlsx", sheet = "Sheet 1"))

# number of individuals
N <- dim(Y_obs)[1]

# number of time periods
no_periods <- dim(Y_obs)[2]

# indexes t
indexes_t <- 1:no_periods

# plot Y_obs
plot(x = indexes_t,
     y = c(min(Y_obs),
           max(Y_obs),
           rep(min(Y_obs), times = no_periods-2)),
     type = "l",
     col = "white",
     main = "Observed dependent variable",
     xlab = "t",
     ylab = "y_obs")
  
grid(nx = NA, ny = NULL)
par(new = TRUE)
  
for (n in 1:N) {
  lines(x = indexes_t,
        y = Y_obs[n,],
        col = "orange")
}

box()
```


## Simulation case 6
Within each simulation run, for $n$ in $1,...,250$ and $t$ in $1,...,10$,

* $\boldsymbol{y}^{obs}_{n} \sim Normal(1.5 - 0.5 \, \boldsymbol{x}_{n},0.25) \quad \text{if } z_n = 1\text{,}$

* $\boldsymbol{y}^{obs}_{n} \sim Normal(2.5 + 0.5 \, \boldsymbol{x}_{n},0.5) \quad \text{if } z_n = 2\text{,}$

* $\boldsymbol{y}^{obs}_{n} \sim Normal(3.5 + 1 \, \boldsymbol{x}_{n},0.75) \quad \text{if } z_n = 3\text{, and}$

* $z_n \sim Categorical(0.3,0.2,0.5)\text{;}$

where $\boldsymbol{x}_{n} = (0,1,2,3,4,5,6,7,8,9)$


```{r}
# load observed dependent variable
Y_obs <- data.frame(read_excel("Model1/Dataset6_Yobs.xlsx", sheet = "Sheet 1"))

# number of individuals
N <- dim(Y_obs)[1]

# number of time periods
no_periods <- dim(Y_obs)[2]

# indexes t
indexes_t <- 1:no_periods

# plot Y_obs
plot(x = indexes_t,
     y = c(min(Y_obs),
           max(Y_obs),
           rep(min(Y_obs), times = no_periods-2)),
     type = "l",
     col = "white",
     main = "Observed dependent variable",
     xlab = "t",
     ylab = "y_obs")
  
grid(nx = NA, ny = NULL)
par(new = TRUE)
  
for (n in 1:N) {
  lines(x = indexes_t,
        y = Y_obs[n,],
        col = "orange")
}

box()
```


## Simulation case 15
Within each simulation run, for $n$ in $1,...,50$ and $t$ in $1,...,10$,

$\boldsymbol{y}^{obs}_{n} \sim PoissonLog(5 + 0.1 \, \boldsymbol{x}_{n})\text{;}$

where $\boldsymbol{x}_{n} = (0,1,2,3,4,5,6,7,8,9)$


```{r}
# load observed dependent variable
Y_obs <- data.frame(read_excel("Model3/Dataset15_Yobs.xlsx", sheet = "Sheet 1"))

# number of individuals
N <- dim(Y_obs)[1]

# number of time periods
no_periods <- dim(Y_obs)[2]

# indexes t
indexes_t <- 1:no_periods

# plot Y_obs
plot(x = indexes_t,
     y = c(min(Y_obs),
           max(Y_obs),
           rep(min(Y_obs), times = no_periods-2)),
     type = "l",
     col = "white",
     main = "Observed dependent variable",
     xlab = "t",
     ylab = "y_obs")
  
grid(nx = NA, ny = NULL)
par(new = TRUE)
  
for (n in 1:N) {
  lines(x = indexes_t,
        y = Y_obs[n,],
        col = "orange")
}

box()
```


## Simulation case 16
Within each simulation run, for $n$ in $1,...,200$ and $t$ in $1,...,10$,

* $\boldsymbol{y}^{obs}_{n} \sim PoissonLog(1 + 0.4 \, \boldsymbol{x}_{n}) \quad \text{if } z_n = 1\text{,}$

* $\boldsymbol{y}^{obs}_{n} \sim PoissonLog(5 + 0.1 \, \boldsymbol{x}_{n}) \quad \text{if } z_n = 2\text{, and}$

* $z_n \sim Categorical(0.3,0.7)\text{;}$

where $\boldsymbol{x}_{n} = (0,1,2,3,4,5,6,7,8,9)$


```{r}
# load observed dependent variable
Y_obs <- data.frame(read_excel("Model3/Dataset16_Yobs.xlsx", sheet = "Sheet 1"))
Y_obs_log <- data.frame(read_excel("Model3/Dataset16_Yobslog.xlsx", sheet = "Sheet 1"))

# number of individuals
N <- dim(Y_obs)[1]

# number of time periods
no_periods <- dim(Y_obs)[2]

# indexes t
indexes_t <- 1:no_periods

# plot Y_obs
plot(x = indexes_t,
     y = c(min(Y_obs),
           max(Y_obs),
           rep(min(Y_obs), times = no_periods-2)),
     type = "l",
     col = "white",
     main = "Observed dependent variable",
     xlab = "t",
     ylab = "y_obs")
  
grid(nx = NA, ny = NULL)
par(new = TRUE)
  
for (n in 1:N) {
  lines(x = indexes_t,
        y = Y_obs[n,],
        col = "orange")
}

box()

# plot Y_obs_log
plot(x = indexes_t,
     y = c(min(Y_obs_log),
           max(Y_obs_log),
           rep(min(Y_obs_log), times = no_periods-2)),
     type = "l",
     col = "white",
     main = "Observed dependent variable on log scale",
     xlab = "t",
     ylab = "y_obs_log")
  
grid(nx = NA, ny = NULL)
par(new = TRUE)
  
for (n in 1:N) {
  lines(x = indexes_t,
        y = Y_obs_log[n,],
        col = "orange")
}

box()
```


## Simulation case 17
Within each simulation run, for $n$ in $1,...,200$ and $t$ in $1,...,10$,

* $\boldsymbol{y}^{obs}_{n} \sim PoissonLog(4.75 + 0.05 \, \boldsymbol{x}_{n}) \quad \text{if } z_n = 1\text{,}$

* $\boldsymbol{y}^{obs}_{n} \sim PoissonLog(5 + 0.1 \, \boldsymbol{x}_{n}) \quad \text{if } z_n = 2\text{, and}$

* $z_n \sim Categorical(0.3,0.7)\text{;}$

where $\boldsymbol{x}_{n} = (0,1,2,3,4,5,6,7,8,9)$


```{r}
# load observed dependent variable
Y_obs <- data.frame(read_excel("Model3/SimCase17_Yobs_SimRun1.xlsx",
                               sheet = "Sheet 1"))
Y_obs_log <- data.frame(read_excel("Model3/SimCase17_Yobslog_SimRun1.xlsx",
                                   sheet = "Sheet 1"))
  
# number of individuals
N <- dim(Y_obs)[1]
  
# number of time periods
no_periods <- dim(Y_obs)[2]
  
# indexes t
indexes_t <- 1:no_periods
  
# plot Y_obs
plot(x = indexes_t,
     y = c(min(Y_obs),
           max(Y_obs),
           rep(min(Y_obs), times = no_periods-2)),
     type = "l",
     col = "white",
     main = "Observed dependent variable for simulation run 1",
     xlab = "t",
     ylab = "y_obs")
  
grid(nx = NA, ny = NULL)
par(new = TRUE)
  
for (n in 1:N) {
  lines(x = indexes_t,
        y = Y_obs[n,],
        col = "orange")
}
  
box()
  
# plot Y_obs_log
plot(x = indexes_t,
     y = c(min(Y_obs_log),
           max(Y_obs_log),
           rep(min(Y_obs_log), times = no_periods-2)),
     type = "l",
     col = "white",
     main = "Observed dependent variable on log scale for simulation run 1",
     xlab = "t",
     ylab = "y_obs_log")

grid(nx = NA, ny = NULL)
par(new = TRUE)
  
for (n in 1:N) {
  lines(x = indexes_t,
        y = Y_obs_log[n,],
        col = "orange")
}
  
box()
```


## Simulation case 18
Within each simulation run, for $n$ in $1,...,200$ and $t$ in $1,...,10$,

* $\boldsymbol{y}^{obs}_{n} \sim PoissonLog(1 + 0.4 \, \boldsymbol{x}_{n}) \quad \text{if } z_n = 1\text{,}$

* $\boldsymbol{y}^{obs}_{n} \sim PoissonLog(5 - 0.2 \, \boldsymbol{x}_{n}) \quad \text{if } z_n = 2\text{, and}$

* $z_n \sim Categorical(0.3,0.7)\text{;}$

where $\boldsymbol{x}_{n} = (0,1,2,3,4,5,6,7,8,9)$


```{r}
# load observed dependent variable
Y_obs <- data.frame(read_excel("Model3/SimCase18_Yobs_SimRun1.xlsx",
                               sheet = "Sheet 1"))
Y_obs_log <- data.frame(read_excel("Model3/SimCase18_Yobslog_SimRun1.xlsx",
                                   sheet = "Sheet 1"))
  
# number of individuals
N <- dim(Y_obs)[1]
  
# number of time periods
no_periods <- dim(Y_obs)[2]
  
# indexes t
indexes_t <- 1:no_periods
  
# plot Y_obs
plot(x = indexes_t,
     y = c(min(Y_obs),
             max(Y_obs),
             rep(min(Y_obs), times = no_periods-2)),
     type = "l",
     col = "white",
     main = "Observed dependent variable for simulation run 1",
     xlab = "t",
     ylab = "y_obs")
  
grid(nx = NA, ny = NULL)
par(new = TRUE)
  
for (n in 1:N) {
  lines(x = indexes_t,
        y = Y_obs[n,],
        col = "orange")
}
  
box()
  
# plot Y_obs_log
plot(x = indexes_t,
     y = c(min(Y_obs_log),
           max(Y_obs_log),
           rep(min(Y_obs_log), times = no_periods-2)),
     type = "l",
     col = "white",
     main = "Observed dependent variable on log scale for simulation run 1",
     xlab = "t",
     ylab = "y_obs_log")

grid(nx = NA, ny = NULL)
par(new = TRUE)

for (n in 1:N) {
  lines(x = indexes_t,
        y = Y_obs_log[n,],
        col = "orange")
}
  
box()
```


## Simulation case 29
Within each simulation run, for $n$ in $1,...,200$ and $t$ in $1,...,10$,

* $\boldsymbol{y}^{obs}_{n} \sim Normal(-5 - 0.5 \, \boldsymbol{x}_{n},0.25) \quad \text{if } z_n = 1\text{,}$

* $\boldsymbol{y}^{obs}_{n} \sim Normal(10 + 1 \, \boldsymbol{x}_{n},0.75) \quad \text{if } z_n = 2\text{,}$

* $z_{n,t} \sim Categorical(0.3,0.7) \quad \text{for } t = 1\text{, and}$

* $z_{n,t} \sim Categorical(\boldsymbol{\psi}_{z_{n,t-1}}) \quad \text{for } t > 1\text{;}$

where $\boldsymbol{x}_{n} = (0,1,2,3,4,5,6,7,8,9)$, $\boldsymbol{\psi}_1 = (0.99,0.01)$, and $\boldsymbol{\psi}_2 = (0.05,0.95)$


```{r}
# load observed dependent variable
Y_obs <- data.frame(read_excel("Model5/SimCase29_Yobs_SimRun1.xlsx",
                               sheet = "Sheet 1"))
  
# number of individuals
N <- dim(Y_obs)[1]
  
# number of time periods
no_periods <- dim(Y_obs)[2]
  
# indexes t
indexes_t <- 1:no_periods
  
# plot Y_obs
plot(x = indexes_t,
     y = c(min(Y_obs),
           max(Y_obs),
           rep(min(Y_obs), times = no_periods-2)),
     type = "l",
     col = "white",
     main = "Observed dependent variable for simulation run 1",
     xlab = "t",
     ylab = "y_obs")
  
grid(nx = NA, ny = NULL)
par(new = TRUE)
  
for (n in 1:N) {
  lines(x = indexes_t,
        y = Y_obs[n,],
        col = "orange")
}
  
box()
```


